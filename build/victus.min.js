// victus | (c) 2021 sporeball & contributors | MIT license
!function(){let t,e,s,o,i,l,h,c,n,r,a,d,u=Math.PI,y=Object;class x{constructor(t,e,s,o,i){c=this,c.x=t,c.y=e,c.w=s,c.h=o,c.xv=c.yv=c.rotation=0,c.ax=c.w/2,c.ay=c.h/2,c.hidden=0,c.setProps(i)}moveTo(t,e){this.x=t,this.y=e}moveBy(t,e){this.x+=t,this.y+=e}anchor(t,e){this.ax=t,this.ay=e}hide(){this.hidden=1}show(){this.hidden=0}setProps(t){Object.assign(this,t)}clone(t){return n=y.assign(y.create(this),this),n.setProps(t),n}draw(){c=this,c.moveBy(c.xv/60,c.yv/60),r=c.x+c.ax,a=c.y+c.ay,e.sv(),e.ta(r,a),e.rt(c.rotation*(u/180)),e.ta(-r,-a),c.hidden||c._(),e.re()}}class p extends x{constructor(t,e,s,o,i,l){super(t,e,s,o,l),this.col=i}_(){k(c.x,c.y,c.w,c.h,c.col)}}l={},onkeydown=onkeyup=t=>{l[t.key]=t.type[5]},h={x:0,y:0,click:0,held:0},onmousemove=t=>{h.x=t.pageX,h.y=t.pageY},onmousedown=t=>{1==t.which&&(h.held||(h.click=1),h.held=1)},onmouseup=t=>{1==t.which&&(h.held=0)},k=(t=0,l=0,h=s,c=o,n=i)=>{e.fillStyle=n,e.fc(t,l,h,c)},victus={setup:l=>{for(d in t=this[l.id],e=t.getContext`2d`,victus.ctx=e,e)e[d[0]+(d[6]||d[2])]=e[d];s=t.width=l.w,o=t.height=l.h,i=l.color||"#fff"},Rect:p,Ellipse:class extends p{constructor(t,e,s,o,i,l){super(t,e,s,o,i,l)}_(){e.fillStyle=c.col,e.ba(),e.ee(c.x,c.y,c.w,c.h,0,0,2*u),e.ca(),e.fl()}},Sprite:class extends x{constructor(t,e,s,o,i,l){super(e,s,o,i,l),(this.d=new Image).src=t}_(){e.da(c.d,c.x,c.y,c.w,c.h)}},Text:class extends x{constructor(t,e,s,o=16,i="#000",l="Arial",h="left"){super(e,s),c=this,c.str=t,c.size=o,c.col=i,c.font=l,c.align=h}_(){e.fillStyle=c.col,e.font=c.size+"px "+c.font,e.textAlign=c.align,e.fx(c.str,c.x,c.y)}},Sound:class{constructor(t,e,s=0){c=this,c.vol=e,(c.d=new Audio(t)).loop=s}reset(){this.d.currentTime=0}play(){c=this,c.d.volume=c.vol,c.d.play()}pause(){this.d.pause()}},keys:l,mouse:h,clear:k}}();