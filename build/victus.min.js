// victus | (c) 2021 sporeball & contributors | MIT license
!function(){let t,e,s,o,h,r,l,n,a,d,u,p,y=Math.PI,w=Object;class f{constructor(t,e,s,o,i){n=this,n.x=t,n.y=e,n.w=s,n.h=o,n.xv=n.yv=n.rotation=0,n.anchorX=n.w/2,n.anchorY=n.h/2,n.hidden=0,n.setProps(i)}moveTo(t,e){this.x=t,this.y=e}moveBy(t,e){this.x+=t,this.y+=e}anchor(t,e){this.anchorX=t,this.anchorY=e}hide(){this.hidden=1}show(){this.hidden=0}setProps(t){Object.assign(this,t)}clone(t){return a=c(this),a.setProps(t),a}draw(){n=this,n.moveBy(n.xv,n.yv),d=n.x+n.anchorX,u=n.y+n.anchorY,e.save(),e[c="translate"](d,u),e.rotate(n.rotation*(y/180)),e[c](-d,-u),n.hidden||n._(),e.restore()}}r={Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown"},[..."ABCDEFGHIJKLMNOPQRSTUVWXYZ"].map(t=>r[t]="Key"+t),l={x:0,y:0,click:0,held:0},document.onmousemove=t=>{l.x=t.pageX,l.y=t.pageY},document.onmousedown=t=>{1==t.which&&(l.held||(l.click=1),l.held=1)},document.onmouseup=t=>{1==t.which&&(l.held=0)},c=t=>{for(i in p=w.create(t),t)p[i]=t[i];return p},k=(t=0,i=0,c=s,r=o,l=h)=>{e.fillStyle=l,e.fillRect(t,i,c,r)},x=t=>e,this.victus={setup:i=>{t=document.getElementById(i.id),e=t.getContext`2d`,s=t.width=i.w,o=t.height=i.h,h=i.color||"#fff"},Rect:class extends f{constructor(t,e,s,o,i,c){super(t,e,s,o,c),this.col=i}_(){k(n.x,n.y,n.w,n.h,n.col)}},Ellipse:class extends f{constructor(t,e,s,o,i,c){super(t,e,s,o,c),this.col=i}_(){e.fillStyle=n.col,e.beginPath(),e.ellipse(n.x,n.y,n.w,n.h,0,0,2*y),e.closePath(),e.fill()}},Sprite:class extends f{constructor(t,e,s,o,i,c){super(e,s,o,i,c),this.d=new Image,this.d.src=t}_(){e.drawImage(n.d,n.x,n.y,n.w,n.h)}},Text:class extends f{constructor(t,e,s,o=16,i="#000",c="Arial",h="left"){super(e,s),n=this,n.str=t,n.size=o,n.col=i,n.font=c,n.align=h}_(){e.fillStyle=n.col,e.font=n.size+"px "+n.font,e.textAlign=n.align,e.fillText(n.str,n.x,n.y)}},Sound:class{constructor(t,e,s=0){n=this,n.vol=e,n.d=new Audio(t),n.d.loop=s}reset(){this.d.load()}play(){n=this,n.reset(),n.d.volume=n.vol,n.d.play()}pause(){this.d.pause()}},keys:r,mouse:l,clear:k}}();