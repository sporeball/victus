// victus | (c) 2021 sporeball & contributors | MIT license
!function(){let t,e,s,o,i,h,l,r,n,c,a,d=Math.PI,u=Object;class p{constructor(t,e,s,o,i){r=this,r.x=t,r.y=e,r.w=s,r.h=o,r.xv=r.yv=r.rotation=0,r.anchorX=r.w/2,r.anchorY=r.h/2,r.hidden=0,r.setProps(i)}moveTo(t,e){this.x=t,this.y=e}moveBy(t,e){this.x+=t,this.y+=e}anchor(t,e){this.anchorX=t,this.anchorY=e}hide(){this.hidden=1}show(){this.hidden=0}setProps(t){Object.assign(this,t)}clone(t){return n=u.assign(u.create(this),this),n.setProps(t),n}draw(){r=this,r.moveBy(r.xv,r.yv),c=r.x+r.anchorX,a=r.y+r.anchorY,e.sv(),e.ta(c,a),e.rt(r.rotation*(d/180)),e.ta(-c,-a),r.hidden||r._(),e.re()}}h={Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown"},[..."ABCDEFGHIJKLMNOPQRSTUVWXYZ"].map(t=>h[t]="Key"+t),l={x:0,y:0,click:0,held:0},onmousemove=t=>{l.x=t.pageX,l.y=t.pageY},onmousedown=t=>{1==t.which&&(l.held||(l.click=1),l.held=1)},onmouseup=t=>{1==t.which&&(l.held=0)},k=(t=0,h=0,l=s,r=o,n=i)=>{e.fillStyle=n,e.fc(t,h,l,r)},x=t=>e,this.victus={setup:h=>{for(Z in t=document.getElementById(h.id),e=t.getContext`2d`,e)e[Z[0]+(Z[6]||Z[2])]=e[Z];s=t.width=h.w,o=t.height=h.h,i=h.color||"#fff"},Rect:class extends p{constructor(t,e,s,o,i,h){super(t,e,s,o,h),this.col=i}_(){k(r.x,r.y,r.w,r.h,r.col)}},Ellipse:class extends p{constructor(t,e,s,o,i,h){super(t,e,s,o,h),this.col=i}_(){e.fillStyle=r.col,e.ba(),e.ee(r.x,r.y,r.w,r.h,0,0,2*d),e.ca(),e.fl()}},Sprite:class extends p{constructor(t,e,s,o,i,h){super(e,s,o,i,h),this.d=new Image,this.d.src=t}_(){e.da(r.d,r.x,r.y,r.w,r.h)}},Text:class extends p{constructor(t,e,s,o=16,i="#000",h="Arial",l="left"){super(e,s),r=this,r.str=t,r.size=o,r.col=i,r.font=h,r.align=l}_(){e.fillStyle=r.col,e.font=r.size+"px "+r.font,e.textAlign=r.align,e.fx(r.str,r.x,r.y)}},Sound:class{constructor(t,e,s=0){r=this,r.vol=e,r.d=new Audio(t),r.d.loop=s}reset(){this.d.load()}play(){r=this,r.reset(),r.d.volume=r.vol,r.d.play()}pause(){this.d.pause()}},keys:h,mouse:l,clear:k}}();