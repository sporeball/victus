// victus | (c) 2021 sporeball | MIT license
!function(){let t,e,s,o,l,h,r,n=Math.PI,a=Object;class d{constructor(t,e,s,o,i){r=this,r.x=t,r.y=e,r.w=s,r.h=o,r.xv=r.yv=r.rotation=0,r.anchorX=r.w/2,r.anchorY=r.h/2,r.hidden=0,r.setProps(i)}moveTo(t,e){this.x=t,this.y=e}moveBy(t,e){this.x+=t,this.y+=e}anchor(t,e){this.anchorX=t,this.anchorY=e}hide(){this.hidden=1}show(){this.hidden=0}setProps(t){Object.assign(this,t)}clone(t){let e=c(this);return e.setProps(t),e}draw(){r=this,r.moveBy(r.xv,r.yv);let t=r.x+r.anchorX,s=r.y+r.anchorY;e.save(),e[c="translate"](t,s),e.rotate(r.rotation*(n/180)),e[c](-t,-s),r.hidden||r._(),e.restore()}}let u={Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown"};h="ABCDEFGHIJKLMNOPQRSTUVWXYZ",[..."ABCDEFGHIJKLMNOPQRSTUVWXYZ"].map(t=>u[t]="Key"+t);let p={x:0,y:0,click:0,held:0};document.onmousemove=t=>{p.x=t.pageX,p.y=t.pageY},document.onmousedown=t=>{1==t.which&&(p.held||(p.click=1),p.held=1)},document.onmouseup=t=>{1==t.which&&(p.held=0)},c=t=>{let e=a.create(t);for(i in t)e[i]=t[i];return e},k=(t=0,i=0,c=s,h=o,r=l)=>{e.fillStyle=r,e.fillRect(t,i,c,h)},x=t=>e,this.victus={setup:i=>{t=document.getElementById(i.id),e=t.getContext`2d`,s=t.width=i.w,o=t.height=i.h,l=i.color||"#fff"},Rect:class extends d{constructor(t,e,s,o,i,l){super(t,e,s,o,l),this.col=i}_(){k(r.x,r.y,r.w,r.h,r.col)}},Ellipse:class extends d{constructor(t,e,s,o,i,l){super(t,e,s,o,l),this.col=i}_(){e.fillStyle=r.col,e.beginPath(),e.ellipse(r.x,r.y,r.w,r.h,0,0,2*n),e.closePath(),e.fill()}},Sprite:class extends d{constructor(t,e,s,o,i,l){super(e,s,o,i,l),this.d=new Image,this.d.src=t}_(){e.drawImage(r.d,r.x,r.y,r.w,r.h)}},Text:class extends d{constructor(t,e,s,o=16,i="#000",l="Arial",c="left"){super(e,s),r=this,r.str=t,r.size=o,r.col=i,r.font=l,r.align=c}_(){e.fillStyle=r.col,e.font=r.size+"px "+r.font,e.textAlign=r.align,e.fillText(r.str,r.x,r.y)}},Sound:class{constructor(t,e,s=0){r=this,r.vol=e,r.d=new Audio(t),r.d.loop=s}reset(){this.d.load()}play(){r=this,r.reset(),r.d.volume=r.vol,r.d.play()}pause(){this.d.pause()}},clear:k,keys:u,mouse:p}}();