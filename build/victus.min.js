// victus | (c) 2021 sporeball & contributors | MIT license
!function(){let t,e,s,o,i,l,r,h,c,n,a,d,u=Math.PI,x=Object;class y{constructor(t,e,s,o,i){h=this,h.x=t,h.y=e,h.w=s,h.h=o,h.xv=h.yv=h.rotation=0,h.ax=h.w/2,h.ay=h.h/2,h.hidden=0,h.setProps(i)}moveTo(t,e){this.x=t,this.y=e}moveBy(t,e){this.x+=t,this.y+=e}anchor(t,e){this.ax=t,this.ay=e}hide(){this.hidden=1}show(){this.hidden=0}setProps(t){Object.assign(this,t)}clone(t){return c=x.assign(x.create(this),this),c.setProps(t),c}draw(){h=this,h.moveBy(h.xv,h.yv),n=h.x+h.ax,a=h.y+h.ay,e.sv(),e.ta(n,a),e.rt(h.rotation*(u/180)),e.ta(-n,-a),h.hidden||h._(),e.re()}}class p extends y{constructor(t,e,s,o,i,l){super(t,e,s,o,l),this.col=i}_(){k(h.x,h.y,h.w,h.h,h.col)}}l={Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown"},[..."ABCDEFGHIJKLMNOPQRSTUVWXYZ"].map(t=>l[t]="Key"+t),r={x:0,y:0,click:0,held:0},onmousemove=t=>{r.x=t.pageX,r.y=t.pageY},onmousedown=t=>{1==t.which&&(r.held||(r.click=1),r.held=1)},onmouseup=t=>{1==t.which&&(r.held=0)},k=(t=0,l=0,r=s,h=o,c=i)=>{e.fillStyle=c,e.fc(t,l,r,h)},victus={setup:l=>{for(d in t=document.getElementById(l.id),e=t.getContext`2d`,victus.ctx=e,e)e[d[0]+(d[6]||d[2])]=e[d];s=t.width=l.w,o=t.height=l.h,i=l.color||"#fff"},Rect:p,Ellipse:class extends p{constructor(t,e,s,o,i,l){super(t,e,s,o,i,l)}_(){e.fillStyle=h.col,e.ba(),e.ee(h.x,h.y,h.w,h.h,0,0,2*u),e.ca(),e.fl()}},Sprite:class extends y{constructor(t,e,s,o,i,l){super(e,s,o,i,l),(this.d=new Image).src=t}_(){e.da(h.d,h.x,h.y,h.w,h.h)}},Text:class extends y{constructor(t,e,s,o=16,i="#000",l="Arial",r="left"){super(e,s),h=this,h.str=t,h.size=o,h.col=i,h.font=l,h.align=r}_(){e.fillStyle=h.col,e.font=h.size+"px "+h.font,e.textAlign=h.align,e.fx(h.str,h.x,h.y)}},Sound:class{constructor(t,e,s=0){h=this,h.vol=e,(h.d=new Audio(t)).loop=s}reset(){this.d.load()}play(){h=this,h.reset(),h.d.volume=h.vol,h.d.play()}pause(){this.d.pause()}},keys:l,mouse:r,clear:k}}();